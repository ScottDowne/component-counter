<polymer-element name="ceci-counter" attributes="unit value increment" extends="ceci-element">
  <template>
    <style>
      :host {
        display: block;
        width: 100%;
        height: 50px;
      }

      :host .counter {
        line-height: 3.8rem;
        text-align: center;
        font-size: font-size: 1.6rem;
        font-family: "FiraSans", sans-serif;
        padding: .5rem 0rem;
        background: #DDD;
        color: #666;
      }

      :host .counter .count-wrapper {
        background: white;
        padding: .5rem 1rem;
        border-radius: .5rem;
        -moz-border-radius: .5rem;
        border-bottom: solid 1px #CCC;
      }
      :host .count-label {
        margin-left: 1ex;
      }

    </style>
    <div class="counter">
      <span class="count-wrapper"><span id="count" class="count">0</span><span id="label" class="count-label"></span></span>
    </div>
    <content select="ceci-broadcast"></content>
    <content select="ceci-listen"></content>
  </template>
  <script>
    Polymer('ceci-counter', {
      ready: function () {
        this.ceci({
          broadcasts: ['click'],
          defaultBroadcasts: ['click']
        });
        this.setValue(JSON.parse(this.getAttribute('value') || '0')); // XXX harden
        this.increment = JSON.parse(this.getAttribute('increment') || '1'); // XXX harden
      },
      countUp: function(thing) {
        this.setValue(this.getValue() + this.increment);
      },
      countDown: function(thing) {
        this.setValue(this.getValue() - this.increment);
      },
      setValue: function(value) {
        this.value = value;
        this.updateDisplay();
      },
      getValue: function() {
        return JSON.parse(this.$.count.innerHTML);
      },
      unitChanged: function (oldValue, newValue) {
        this.$.label.innerHTML = newValue;
        this.updateDisplay();
      },
      updateDisplay: function() {
        this.$.count.innerHTML = JSON.stringify(this.value);
      }
    });
  </script>
</polymer-element>
